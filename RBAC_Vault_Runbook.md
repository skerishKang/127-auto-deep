# 운영 런북 — RBAC / Secrets Vault

## 1. 목적
워크스페이스/프로젝트별 최소권한과 비밀키(LLM/Slack/DB 등)를 안전하게 관리한다.

## 2. 구성
- **RBAC**: Owner/Admin/Editor/Viewer (워크스페이스/프로젝트 스코프)
- **Vault**: KMS 연동, 키 생성/조회/회전 API, 감사로그

## 3. 절차
### 3.1 온보딩
1) Workspace 생성 → Owner 지정
2) 프로젝트/템플릿 접근 권한(Role) 배정
3) Secrets 범위(scope=workspace|project) 정의

### 3.2 시크릿 등록/회전
- 등록: provider(openai, anthropic, google, gmail, drive, slack, s3 등), key_ref 저장
- 회전: 만료 15일 전 알림 → 신규 키 검증 → 교체 → 영향도 점검
- 감사: 누가/언제/어떤 범위로 조회/갱신했는지 기록

### 3.3 실행 차단/폴백
- 필요한 Secret 미존재 시 실행 차단 + 가이드
- 공급자 장애 시 폴백(모델 스위칭), 재시도(백오프) 적용

### 3.4 접근 제어 모범 사례
- 최소 권한(읽기/실행/편집/배포 분리)
- 민감 템플릿은 승인 워크플로 필수
- IP 제한(옵션), 2FA, 세션 만료

## 4. 모니터링
- Secret 사용량, 실패율, 회전 이력
- 권한 변경/배포 이력 알림
- 이상 탐지(짧은 시간 대량 호출 등)

## 5. 장애 대응
- 긴급 키 폐기(denylist) → 폴백 키 즉시 적용
- 영향 워크플로 목록/우선순위 복구
- 사후 RCA 및 룰 업데이트